function xOut = bongWieCont(t,x,SC,ctrl)
    
    % Earth gravitational constant
    muEarth = 398600.4415 * 1e9;

    % Control and dynamics constants
    J11 = SC.J(1,1);
    J22 = SC.J(2,2);
    J33 = SC.J(3,3);
    J12 = SC.J(1,2);
    J13 = SC.J(1,3);
    J23 = SC.J(2,3);

    K1 = ctrl.K(1,1);
    K2 = ctrl.K(2,2);
    K3 = ctrl.K(3,3);

    D1 = ctrl.D(1,1);
    D2 = ctrl.D(2,2);
    D3 = ctrl.D(3,3);

    mu = ctrl.mu;
    J11e = ctrl.Jest(1,1);
    J22e = ctrl.Jest(2,2);
    J33e = ctrl.Jest(3,3);
    J12e = ctrl.Jest(1,2);
    J13e = ctrl.Jest(1,3);
    J23e = ctrl.Jest(2,3);

    q1c = ctrl.qc(1);
    q2c = ctrl.qc(2);
    q3c = ctrl.qc(3);
    q4c = ctrl.qc(4);
    
    % Set up dynamic equations
    %   x(1)  = r1dot
    %   x(2)  = r2dot
    %   x(3)  = r3dot
    %   x(4)  = v1dot
    %   x(5)  = v2dot
    %   x(6)  = v3dot
    %   x(7)  = q1dot
    %   x(8)  = q2dot
    %   x(9)  = q3dot
    %   x(10) = q4dot
    %   x(11) = w1dot
    %   x(12) = w2dot
    %   x(13) = w3dot

    xOut = [ x(4)
             x(5)
             x(6)
            -muEarth*x(1) / (x(1)*x(1) + x(2)*x(2) + x(3)*x(3))^(3/2)
            -muEarth*x(2) / (x(1)*x(1) + x(2)*x(2) + x(3)*x(3))^(3/2)
            -muEarth*x(3) / (x(1)*x(1) + x(2)*x(2) + x(3)*x(3))^(3/2)
             0.5 * ( x(8)*x(13) - x(9)*x(12) + x(10)*x(11))
             0.5 * ( x(9)*x(11) - x(7)*x(13) + x(10)*x(12))
             0.5 * ( x(7)*x(12) - x(8)*x(11) + x(10)*x(13))
             0.5 * (-x(7)*x(11) - x(8)*x(12) -  x(9)*x(13))
             ((J12*J23 - J13*J22)*(K3*(x(7)*q2c - x(8)*q1c + x(9)*q4c - x(10)*q3c) + D3*x(13) + mu*(x(12)*(J11e*x(11) + J12e*x(12) + J13e*x(13)) - x(11)*(J12e*x(11) + J22e*x(12) + J23e*x(13))) - x(12)*(J11*x(11) + J12*x(12) + J13*x(13)) + x(11)*(J12*x(11) + J22*x(12) + J23*x(13))))/(J33*J12^2 - 2*J12*J13*J23 + J22*J13^2 + J11*J23^2 - J11*J22*J33) - ((J23^2 - J22*J33)*(K1*(x(7)*q4c + x(8)*q3c - x(9)*q2c - x(10)*q1c) + D1*x(11) + mu*(x(13)*(J12e*x(11) + J22e*x(12) + J23e*x(13)) - x(12)*(J13e*x(11) + J23e*x(12) + J33e*x(13))) - x(13)*(J12*x(11) + J22*x(12) + J23*x(13)) + x(12)*(J13*x(11) + J23*x(12) + J33*x(13))))/(J33*J12^2 - 2*J12*J13*J23 + J22*J13^2 + J11*J23^2 - J11*J22*J33) - ((J13*J23 - J12*J33)*(K2*(x(7)*q3c - x(9)*q1c - x(8)*q4c + x(10)*q2c) - D2*x(12) + mu*(x(13)*(J11e*x(11) + J12e*x(12) + J13e*x(13)) - x(11)*(J13e*x(11) + J23e*x(12) + J33e*x(13))) - x(13)*(J11*x(11) + J12*x(12) + J13*x(13)) + x(11)*(J13*x(11) + J23*x(12) + J33*x(13))))/(J33*J12^2 - 2*J12*J13*J23 + J22*J13^2 + J11*J23^2 - J11*J22*J33)
             ((J13^2 - J11*J33)*(K2*(x(7)*q3c - x(9)*q1c - x(8)*q4c + x(10)*q2c) - D2*x(12) + mu*(x(13)*(J11e*x(11) + J12e*x(12) + J13e*x(13)) - x(11)*(J13e*x(11) + J23e*x(12) + J33e*x(13))) - x(13)*(J11*x(11) + J12*x(12) + J13*x(13)) + x(11)*(J13*x(11) + J23*x(12) + J33*x(13))))/(J33*J12^2 - 2*J12*J13*J23 + J22*J13^2 + J11*J23^2 - J11*J22*J33) + ((J12*J13 - J11*J23)*(K3*(x(7)*q2c - x(8)*q1c + x(9)*q4c - x(10)*q3c) + D3*x(13) + mu*(x(12)*(J11e*x(11) + J12e*x(12) + J13e*x(13)) - x(11)*(J12e*x(11) + J22e*x(12) + J23e*x(13))) - x(12)*(J11*x(11) + J12*x(12) + J13*x(13)) + x(11)*(J12*x(11) + J22*x(12) + J23*x(13))))/(J33*J12^2 - 2*J12*J13*J23 + J22*J13^2 + J11*J23^2 - J11*J22*J33) + ((J13*J23 - J12*J33)*(K1*(x(7)*q4c + x(8)*q3c - x(9)*q2c - x(10)*q1c) + D1*x(11) + mu*(x(13)*(J12e*x(11) + J22e*x(12) + J23e*x(13)) - x(12)*(J13e*x(11) + J23e*x(12) + J33e*x(13))) - x(13)*(J12*x(11) + J22*x(12) + J23*x(13)) + x(12)*(J13*x(11) + J23*x(12) + J33*x(13))))/(J33*J12^2 - 2*J12*J13*J23 + J22*J13^2 + J11*J23^2 - J11*J22*J33)
             ((J12*J23 - J13*J22)*(K1*(x(7)*q4c + x(8)*q3c - x(9)*q2c - x(10)*q1c) + D1*x(11) + mu*(x(13)*(J12e*x(11) + J22e*x(12) + J23e*x(13)) - x(12)*(J13e*x(11) + J23e*x(12) + J33e*x(13))) - x(13)*(J12*x(11) + J22*x(12) + J23*x(13)) + x(12)*(J13*x(11) + J23*x(12) + J33*x(13))))/(J33*J12^2 - 2*J12*J13*J23 + J22*J13^2 + J11*J23^2 - J11*J22*J33) - ((J12*J13 - J11*J23)*(K2*(x(7)*q3c - x(9)*q1c - x(8)*q4c + x(10)*q2c) - D2*x(12) + mu*(x(13)*(J11e*x(11) + J12e*x(12) + J13e*x(13)) - x(11)*(J13e*x(11) + J23e*x(12) + J33e*x(13))) - x(13)*(J11*x(11) + J12*x(12) + J13*x(13)) + x(11)*(J13*x(11) + J23*x(12) + J33*x(13))))/(J33*J12^2 - 2*J12*J13*J23 + J22*J13^2 + J11*J23^2 - J11*J22*J33) - ((J12^2 - J11*J22)*(K3*(x(7)*q2c - x(8)*q1c + x(9)*q4c - x(10)*q3c) + D3*x(13) + mu*(x(12)*(J11e*x(11) + J12e*x(12) + J13e*x(13)) - x(11)*(J12e*x(11) + J22e*x(12) + J23e*x(13))) - x(12)*(J11*x(11) + J12*x(12) + J13*x(13)) + x(11)*(J12*x(11) + J22*x(12) + J23*x(13))))/(J33*J12^2 - 2*J12*J13*J23 + J22*J13^2 + J11*J23^2 - J11*J22*J33)
             ];


end